<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>dev-office-group | Ø³ÛŒØ³ØªÛ•Ù…ÛŒ Ù¾Ø§Ú©Ú©Ø±Ø§ÙˆÛ•</title>
  <style>
    :root { --gold: #c2a24a; --dark: #0f172a; --sidebar: #1e293b; --success: #22c55e; --danger: #ef4444; }
    body { font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; background: #f1f5f9; display: flex; height: 100vh; overflow: hidden; }
    
    /* Login Page Overlay */
    #loginPage { position: fixed; inset: 0; background: var(--dark); display: flex; justify-content: center; align-items: center; z-index: 9999; }
    .login-card { background: white; padding: 40px; border-radius: 20px; width: 380px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); text-align: center; }

    /* Sidebar Navigation */
    #sidebar { width: 260px; background: var(--sidebar); color: white; display: flex; flex-direction: column; transition: 0.3s; }
    .nav-item { padding: 15px 25px; cursor: pointer; display: flex; align-items: center; gap: 10px; transition: 0.2s; border-right: 4px solid transparent; }
    .nav-item:hover, .nav-item.active { background: rgba(255,255,255,0.1); border-right-color: var(--gold); }
    
    /* Main Content Area */
    #main-content { flex: 1; overflow-y: auto; display: flex; flex-direction: column; }
    header { background: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
    
    .view-section { padding: 30px; animation: fadeIn 0.4s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* Modern Table & Cards */
    .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
    .card-stat { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
    .card-stat h4 { margin: 0; color: #64748b; font-size: 14px; }
    .card-stat .value { font-size: 24px; font-weight: bold; margin-top: 5px; color: var(--dark); }

    table { width: 100%; background: white; border-radius: 12px; overflow: hidden; border-collapse: collapse; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
    th { background: #f8fafc; padding: 15px; text-align: center; color: #475569; font-weight: 600; }
    td { padding: 15px; text-align: center; border-top: 1px solid #f1f5f9; }

    /* Buttons & Inputs */
    .btn { padding: 10px 20px; border-radius: 8px; border: none; cursor: pointer; font-weight: 600; transition: 0.2s; }
    .btn-gold { background: var(--gold); color: white; }
    .btn-danger { background: var(--danger); color: white; }
    input, textarea, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #e2e8f0; border-radius: 8px; font-family: inherit; }

    /* Badges */
    .badge { padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: bold; }
    .status-new { background: #dcfce7; color: #166534; }
    .status-process { background: #fef9c3; color: #854d0e; }
    .hidden { display: none !important; }
  </style>
</head>
<body>

<div id="loginPage">
  <div class="login-card">
    <h1 style="margin-bottom:10px; color:var(--dark)">Ø¨Û•Ø®ÛØ±Ø¨ÛÛŒØª</h1>
    <p style="color:#64748b">Ø³ÛŒØ³ØªÛ•Ù…ÛŒ Ø¯ÛŒÚ¤ÛŒÚµÛ†Ù¾ÛŒÙ†Ú¯ÛŒ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Ø±Ø¯Ù†</p>
    <input type="text" id="uName" placeholder="Ù†Ø§ÙˆÛŒ Ø¨Û•Ú©Ø§Ø±Ù‡ÛÙ†Û•Ø±">
    <input type="password" id="uPass" placeholder="ØªÛÙ¾Û•Ú•Û•ÙˆØ´Û•">
    <button class="btn btn-gold" style="width:100%; margin-top:10px;" onclick="doLogin()">Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•</button>
  </div>
</div>

<div id="sidebar" class="hidden">
  <div style="padding: 30px 25px; font-size: 18px; font-weight: bold; color: var(--gold); border-bottom: 1px solid rgba(255,255,255,0.1);">
    Ø³ÛŒØ³ØªÛ•Ù…ÛŒ Ø¯ÛŒÚ¤ÛŒÚµÛ†Ù¾ÛŒÙ†Ú¯
  </div>
  <div class="nav-item active" onclick="switchTab('dashboard')">ğŸ  Ø¯Ø§Ø´Ø¨Û†Ø±Ø¯ÛŒ Ú¯Ø´ØªÛŒ</div>
  <div id="nav-inf" class="nav-item" onclick="switchTab('informer')">ğŸ“ ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ú©Ú•ÛŒØ§Ø±</div>
  <div id="nav-des" class="nav-item" onclick="switchTab('designer')">ğŸ¨ Ø¨Û•Ø´ÛŒ Ø¯ÛŒØ²Ø§ÛŒÙ†</div>
  <div id="nav-man" class="nav-item" onclick="switchTab('manager')">ğŸ’° Ø¨Û•Ú•ÛÙˆÛ•Ø¨Ø±Ø¯Ù†ÛŒ Ø¯Ø§Ø±Ø§ÛŒÛŒ</div>
  <div class="nav-item" onclick="switchTab('chat')">ğŸ’¬ Ú˜ÙˆÙˆØ±ÛŒ Ú¯ÙØªÙˆÚ¯Û†</div>
  <div style="margin-top:auto; padding:20px;">
    <button class="btn btn-danger" style="width:100%" onclick="location.reload()">Ø¯Û•Ø±Ú†ÙˆÙˆÙ† ğŸšª</button>
  </div>
</div>

<div id="main-content" class="hidden">
  <header>
    <div id="welcomeText">Ø¨Û•Ø®ÛØ±Ø¨ÛÛŒØªØŒ <span id="currentUserName"></span></div>
    <div id="dateNow" style="color:#64748b; font-size:14px;"></div>
  </header>

  <div id="tab-dashboard" class="view-section">
    <div class="grid-4">
      <div class="card-stat"><h4>Ú©Û†ÛŒ Ù¾Ú•Û†Ú˜Û•Ú©Ø§Ù†</h4><div class="value" id="stat-total">0</div></div>
      <div class="card-stat"><h4>ØªÛ•ÙˆØ§ÙˆÙ†Û•Ú©Ø±Ø§ÙˆÛ•Ú©Ø§Ù†</h4><div class="value" id="stat-pending" style="color:var(--gold)">0</div></div>
      <div class="card-stat"><h4>Ø¯Ø§Ù‡Ø§Øª</h4><div class="value" id="stat-income">$0</div></div>
      <div class="card-stat"><h4>Ù‚Ø§Ø²Ø§Ù†Ø¬</h4><div class="value" id="stat-profit" style="color:var(--success)">$0</div></div>
    </div>
    <div class="card-stat">
      <div style="display:flex; justify-content:space-between;">
        <h3>ğŸ“ˆ Ú†Ø§Ù„Ø§Ú©ÛŒÛŒÛ•Ú©Ø§Ù†ÛŒ Ø¯ÙˆØ§ÛŒÛŒ</h3>
        <button id="adminOnlyClear" class="btn btn-danger hidden" onclick="clearAllData()" style="padding:5px 10px; font-size:12px;">Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ù‡Û•Ù…ÙˆÙˆ Ø¯Ø§ØªØ§Ú©Ø§Ù†</button>
      </div>
      <table id="recent-activity">
        <thead><tr><th>Ù¾Ú•Û†Ú˜Û•</th><th>Ú©Ú•ÛŒØ§Ø±</th><th>Ø¯Û†Ø®</th><th>Ø¨Û•Ø±ÙˆØ§Ø±</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <div id="tab-informer" class="view-section hidden">
    <div class="card-stat" style="max-width: 600px; margin: auto;">
      <h2>ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ú©Ú•ÛŒØ§Ø±ÛŒ Ù†ÙˆÛ</h2>
      <input id="inf-cust" placeholder="Ù†Ø§ÙˆÛŒ Ú©Ú•ÛŒØ§Ø±">
      <input id="inf-proj" placeholder="Ù†Ø§ÙˆÛŒ Ù¾Ú•Û†Ú˜Û•">
      <textarea id="inf-note" rows="5" placeholder="ØªÛØ¨ÛŒÙ†ÛŒ Ùˆ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛŒÛ•Ú©Ø§Ù†..."></textarea>
      <button class="btn btn-gold" onclick="saveNewProject()">Ù†Ø§Ø±Ø¯Ù† Ø¨Û† Ø¨Û•Ø´ÛŒ Ø¯ÛŒØ²Ø§ÛŒÙ† ğŸš€</button>
    </div>
  </div>

  <div id="tab-designer" class="view-section hidden">
    <h2>ğŸ¨ Ù¾Ú•Û†Ú˜Û• Ú†Ø§ÙˆÛ•Ú•ÙˆØ§Ù†Ú©Ø±Ø§ÙˆÛ•Ú©Ø§Ù†</h2>
    <table id="designer-table">
      <thead><tr><th>Ú©Û†Ø¯</th><th>Ú©Ú•ÛŒØ§Ø±</th><th>Ù¾Ú•Û†Ú˜Û•</th><th>ØªÛØ¨ÛŒÙ†ÛŒ</th><th>Ú©Ø±Ø¯Ø§Ø±</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="tab-manager" class="view-section hidden">
    <h2>ğŸ’° Ø¯Ø§Ø±Ø§ÛŒÛŒ Ùˆ ÙˆØ±Ø¯Û•Ú©Ø§Ø±ÛŒ Ù¾Ú•Û†Ú˜Û•Ú©Ø§Ù†</h2>
    <table id="manager-table">
      <thead><tr><th>Ù¾Ú•Û†Ú˜Û•</th><th>Ø¯Û†Ø®</th><th>Ø®Û•Ø±Ø¬ÛŒ ($)</th><th>Ø¯Ø§Ù‡Ø§Øª ($)</th><th>Ù‚Ø§Ø²Ø§Ù†Ø¬</th><th>Ú©Ø±Ø¯Ø§Ø±</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="tab-chat" class="view-section hidden">
    <div class="card-stat" style="height: 500px; display: flex; flex-direction: column;">
      <div id="chat-messages" style="flex:1; overflow-y:auto; padding:15px; background:#f8fafc; border-radius:10px; margin-bottom:15px;"></div>
      <div style="display:flex; gap:10px;">
        <input id="chat-inp" placeholder="Ù†Ø§Ù…Û•ÛŒÛ•Ú© Ø¨Ù†ÙˆØ³Û•...">
        <button class="btn btn-gold" onclick="doChat()">Ù†Ø§Ø±Ø¯Ù†</button>
      </div>
    </div>
  </div>
</div>

<script>
  // Users Database
  const USERS = {
    "admin": {pass: "1221", role: "manager", name: "Ø¨Û•Ú•ÛÙˆÛ•Ø¨Û•Ø±ÛŒ Ú¯Ø´ØªÛŒ Ø´Ø§Ø²ÛŒØ§Ø± Ù‡ÛÙ…Ù†"},
    "hano": {pass: "1221", role: "designer", name: "Ù‡Ø§Ù†Û† (Ø¯ÛŒØ²Ø§ÛŒÙ†Û•Ø±)"},
    "haryad": {pass: "1221", role: "informer", name: "Ù‡Û•Ø±ÛŒØ§Ø¯ (Ø²Ø§Ù†ÛŒØ§Ø±ÛŒØ¯Û•Ø±)"}
  };

  // Initial Clean State (No hardcoded data)
  let projects = JSON.parse(localStorage.getItem('ent_projs')) || [];
  let chats = JSON.parse(localStorage.getItem('ent_chats')) || [];
  let user = null;

  function doLogin() {
    let u = document.getElementById("uName").value;
    let p = document.getElementById("uPass").value;
    if(USERS[u] && USERS[u].pass === p) {
      user = USERS[u];
      document.getElementById("loginPage").classList.add("hidden");
      document.getElementById("sidebar").classList.remove("hidden");
      document.getElementById("main-content").classList.remove("hidden");
      document.getElementById("currentUserName").innerText = user.name;
      document.getElementById("dateNow").innerText = new Date().toLocaleDateString('ku-IQ');
      
      // Role Control
      if(user.role === 'informer') { 
          document.getElementById("nav-des").classList.add("hidden"); 
          document.getElementById("nav-man").classList.add("hidden"); 
      }
      if(user.role === 'designer') { 
          document.getElementById("nav-inf").classList.add("hidden"); 
          document.getElementById("nav-man").classList.add("hidden"); 
      }
      if(user.role === 'manager') {
          document.getElementById("adminOnlyClear").classList.remove("hidden");
      }
      
      refreshUI();
    } else { alert("Ù†Ø§ÙˆÛŒ Ø¨Û•Ú©Ø§Ø±Ù‡ÛÙ†Û•Ø± ÛŒØ§Ù† ØªÛÙ¾Û•Ú•Û•ÙˆØ´Û• Ù‡Û•ÚµÛ•ÛŒÛ•!"); }
  }

  function switchTab(tabId) {
    document.querySelectorAll(".view-section").forEach(s => s.classList.add("hidden"));
    document.querySelectorAll(".nav-item").forEach(n => n.classList.remove("active"));
    document.getElementById("tab-"+tabId).classList.remove("hidden");
    event.currentTarget.classList.add("active");
    refreshUI();
  }

  function saveNewProject() {
    let cust = document.getElementById("inf-cust").value;
    let proj = document.getElementById("inf-proj").value;
    if(!cust || !proj) return alert("ØªÚ©Ø§ÛŒÛ• Ù‡Û•Ù…ÙˆÙˆ Ø®Ø§Ù†Û•Ú©Ø§Ù† Ù¾Ú• Ø¨Ú©Û•Ø±Û•ÙˆÛ•");

    let p = {
      id: "ID-" + Math.floor(Math.random()*10000),
      cust: cust,
      title: proj,
      note: document.getElementById("inf-note").value,
      status: "Ú†Ø§ÙˆÛ•Ú•ÛÛŒ Ø¯ÛŒØ²Ø§ÛŒÙ†",
      cost: 0, income: 0, date: new Date().toLocaleDateString('ku-IQ')
    };
    projects.push(p);
    save();
    alert("Ù¾Ú•Û†Ú˜Û•Ú©Û• Ù†ÛØ±Ø¯Ø±Ø§ Ø¨Û† Ù‡Ø§Ù†Û†");
    document.getElementById("inf-cust").value = "";
    document.getElementById("inf-proj").value = "";
    document.getElementById("inf-note").value = "";
    switchTab('dashboard');
  }

  function sendToManager(id) {
    projects.find(x => x.id === id).status = "Ú†Ø§ÙˆÛ•Ú•ÛÛŒ Ú˜Ù…ÛØ±ÛŒØ§Ø±ÛŒ";
    save();
    refreshUI();
  }

  function closeProject(id) {
    let p = projects.find(x => x.id === id);
    let c = parseFloat(prompt("Ø®Û•Ø±Ø¬ÛŒ Ù¾Ú•Û†Ú˜Û• ($):", "0")) || 0;
    let i = parseFloat(prompt("Ù¾Ø§Ø±Û•ÛŒ ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§Ùˆ ($):", "0")) || 0;
    p.cost = c;
    p.income = i;
    p.status = "ØªÛ•ÙˆØ§ÙˆØ¨ÙˆÙˆ âœ…";
    save();
    refreshUI();
  }

  function clearAllData() {
      if(confirm("Ø¦Ø§ÛŒØ§ Ø¯ÚµÙ†ÛŒØ§ÛŒ Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ú¯Ø´Øª Ø¯Ø§ØªØ§Ú©Ø§Ù†ØŸ Ø¦Û•Ù… Ú©Ø§Ø±Û• Ù†Ø§Ú¯Û•Ú•ÛØªÛ•ÙˆÛ•.")) {
          projects = [];
          chats = [];
          save();
          refreshUI();
      }
  }

  function refreshUI() {
    // Stats Update
    document.getElementById("stat-total").innerText = projects.length;
    document.getElementById("stat-pending").innerText = projects.filter(x => x.status !== 'ØªÛ•ÙˆØ§ÙˆØ¨ÙˆÙˆ âœ…').length;
    let totalIncome = projects.reduce((a,b) => a + b.income, 0);
    let totalCost = projects.reduce((a,b) => a + b.cost, 0);
    document.getElementById("stat-income").innerText = "$" + totalIncome;
    document.getElementById("stat-profit").innerText = "$" + (totalIncome - totalCost);

    // Activity Table
    const actBody = document.querySelector("#recent-activity tbody");
    actBody.innerHTML = projects.slice(-5).reverse().map(p => `
        <tr><td>${p.title}</td><td>${p.cust}</td><td><span class="badge status-process">${p.status}</span></td><td>${p.date}</td></tr>
    `).join("");

    // Designer Table
    const desBody = document.querySelector("#designer-table tbody");
    desBody.innerHTML = projects.filter(x => x.status === 'Ú†Ø§ÙˆÛ•Ú•ÛÛŒ Ø¯ÛŒØ²Ø§ÛŒÙ†').map(p => `
        <tr><td>${p.id}</td><td>${p.cust}</td><td>${p.title}</td><td>${p.note}</td>
        <td><button class="btn btn-gold" onclick="sendToManager('${p.id}')">Ù†Ø§Ø±Ø¯Ù† Ø¨Û† Ø´Ø§Ø²ÛŒØ§Ø± ğŸ†—</button></td></tr>
    `).join("");

    // Manager Table
    const manBody = document.querySelector("#manager-table tbody");
    manBody.innerHTML = projects.map(p => `
        <tr><td>${p.title}</td><td>${p.status}</td><td>${p.cost}</td><td>${p.income}</td>
        <td style="color:green">$${p.income-p.cost}</td>
        <td>${p.status==='Ú†Ø§ÙˆÛ•Ú•ÛÛŒ Ú˜Ù…ÛØ±ÛŒØ§Ø±ÛŒ'?`<button class="btn btn-gold" onclick="closeProject('${p.id}')">Ø¨Ú•ÛŒÙ†Û•ÙˆÛ•</button>`:'---'}</td></tr>
    `).join("");

    renderChat();
  }

  function doChat() {
    let txt = document.getElementById("chat-inp").value;
    if(!txt) return;
    chats.push({u: user.name, t: txt, time: new Date().toLocaleTimeString('ku-IQ')});
    document.getElementById("chat-inp").value = "";
    save();
    renderChat();
  }

  function renderChat() {
    let c = document.getElementById("chat-messages");
    c.innerHTML = chats.map(m => `
        <div style="margin-bottom:12px; border-bottom:1px solid #eee; padding-bottom:5px;">
            <small style="color:var(--gold); font-weight:bold;">${m.u}</small>
            <div style="font-size:14px;">${m.t}</div>
        </div>
    `).join("");
    c.scrollTop = c.scrollHeight;
  }

  function save() {
    localStorage.setItem('ent_projs', JSON.stringify(projects));
    localStorage.setItem('ent_chats', JSON.stringify(chats));
  }
</script>
</body>
</html>